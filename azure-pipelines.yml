# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  name: Hosted Windows 2019 with VS2019

steps:
 - pwsh: |
    $installer = "C:\Program Files (x86)\Microsoft Visual Studio\Installer\vs_installer.exe"
    $path = "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise"

    $packages = "--add Microsoft.VisualStudio.Component.VC.v141.x86.x64"

    $exitCode = Start-Process -FilePath "$installer" -ArgumentList "modify --installPath `"$path`" $packages --quiet --norestart" -Wait -PassThru
    echo "EXIT: $($exitCode.ExitCode)"
